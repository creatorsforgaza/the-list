[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "The List",
    "section": "",
    "text": "#| echo: false\n#| include: false\n\n# for local\n# drive_auth(path = \".secrets/client_secret.json\")\n# gs4_auth(path = \".secrets/client_secret.json\")\n\n# for gha\ndrive_auth(path = Sys.getenv(\"GOOGLE_AUTHENTICATION_CREDENTIALS\"))\n\ngs4_auth(path = Sys.getenv(\"GOOGLE_AUTHENTICATION_CREDENTIALS\"))\n\nss &lt;- drive_get(id = Sys.getenv(\"GOOGLE_SHEET_ID\") \n                )\n\nsheet_gaza &lt;- read_sheet(ss)\n\n✔ Reading from \"Creators for GFMs &lt;3 SPREADSHEET\".\n\n\n✔ Range 'Sheet1'.\n\n\nNew names:\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...9`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...11`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...12`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...13`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...14`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...15`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...16`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...17`\n\n# idea, when you click \"find out more, it shows the information about the family on the right side of the dashboar\n\n\n#| echo: false\n#| include: false\n\nall_gfm_links &lt;- sheet_gaza %&gt;% \n  # removing fund with broken link for now\n  janitor::clean_names() %&gt;% \n  dplyr::filter(person_family != \"Jenna/Hashem\",\n                status != \"CLOSED / NOT ACCEPTING DONATIONS\") %&gt;%   \n  dplyr::select(links) %&gt;% \n  dplyr::filter(str_detect(links, \"gofund\"))\n\n\ntest_tib &lt;- tibble(\n  # campaign_title = NULL,\n                   link = NULL,\n                   money_raised = NULL,\n                   total_goal_amount = NULL,\n                   total_num_donations = NULL,\n                   total_num_donations_24_hours = NULL,\n                   money_raised_24_hours = NULL,\n                   total_num_donations_last_20 = NULL,\n                   money_raised_last_20 = NULL,\n                   num_days_last_20 = NULL)\n\n\n\nnum_funds &lt;- nrow(all_gfm_links)\n\n\n#| echo: false\n#| include: false\n\n### for last 20 donations\nstart_word &lt;- '\\\\,\\\\\\\\\\\"donations\\\\\\\\\\\"\\\\:\\\\['\nend_word &lt;- 'suggested_donation_stats'\n\nfor(i in 1:5){\n\n  read_html_func &lt;- read_html(as.character(all_gfm_links[i,1]))\n\n  link &lt;- as.character(all_gfm_links[i,1])\n\n  test_tib[i, \"link\"] = link\n\n  # test_tib[i, \"campaign_title\"] = read_html_func %&gt;%\n  #   html_elements(css = \".p-campaign-header\") %&gt;%\n  #   html_text()\n\n  mr_td =  read_html_func %&gt;%\n    html_elements(css = \".hrt-disp-inline\") %&gt;%\n    html_text()\n\n  test_tib[i, \"money_raised\"] = mr_td[1]\n\n  test_tib[i, \"total_num_donations\"] = stringr::str_sub(mr_td[2], start = 2L, end = -2L)\n\n  total_goal = read_html_func %&gt;%\n    html_elements(css = \".hrt-text-body-sm\") %&gt;%\n    html_text()\n\n  test_tib[i, \"total_goal_amount\"] = readr::parse_number(total_goal[1])\n\n  ### 20 most recent donations\n  most_recent_donations = read_html_func %&gt;%\n    html_text() %&gt;%\n    enframe() %&gt;%\n    dplyr::mutate(result =\n                    str_match_all(value,\n                                  paste0(\"(?s)\",\n                                         start_word,\n                                         \"(.*?)\",\n                                         end_word))) %&gt;%\n    dplyr::select(result) %&gt;%\n    unlist()   \n\n  twenty_most_recent_donations = most_recent_donations[[2]][1] %&gt;% \n    tibble::enframe() %&gt;%\n    tidyr::separate_longer_delim(value, delim = \"donation_id\") %&gt;%\n    dplyr::filter(row_number() != 1) %&gt;%\n    tidyr::separate(value, c(\"donation_id\", \"other\"), sep = \"amount\") %&gt;%\n    dplyr::mutate(donation_id = readr::parse_number(donation_id)) %&gt;%\n    tidyr::separate(other, c(\"amount\", \"other\"), sep = \"is_offline\") %&gt;%\n    dplyr::mutate(amount = readr::parse_number(amount)) %&gt;%\n    tidyr::separate(other, c(\"name\", \"other\"), sep = \"created_at\") %&gt;%\n    dplyr::select(-name) %&gt;%\n    tidyr::separate(other, c(\"created_at\", \"other\"), sep = \"name\") %&gt;%\n    dplyr::mutate(created_at = readr::parse_datetime(str_sub(\n      created_at, start = 6L, end = -12L\n    ))) %&gt;%\n    tidyr::separate(other, c(\"name\", \"other\"), sep = \"profile_url\") %&gt;%\n    dplyr::mutate(name = str_sub(name, start = 6L, end = -6L)) %&gt;%\n    dplyr::select(-other) \n  \n  test_tib[i, \"total_num_donations_24_hours\"] = twenty_most_recent_donations %&gt;%\n    dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;%\n    dplyr::summarise(num_donations = n()) %&gt;% \n    dplyr::pull(num_donations)\n  \n  test_tib[i, \"money_raised_24_hours\"] = twenty_most_recent_donations %&gt;%\n    dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;%\n    dplyr::summarise(total_donations_amount = sum(amount)) %&gt;% \n    dplyr::pull(total_donations_amount)\n\n# get the spread from the 20 most recent donations\n  test_tib[i, \"total_num_donations_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      num_donations = n()\n    ) %&gt;% \n    dplyr::pull(num_donations)\n  \n  test_tib[i, \"money_raised_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      total_donations_amount = sum(amount)\n    ) %&gt;% \n    dplyr::pull(total_donations_amount)\n    \n  test_tib[i, \"num_days_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      most_recent_donation = max(created_at),\n      date_of_20th_most_recent_donation = min(created_at)\n    ) %&gt;% \n    dplyr::mutate(days = floor(most_recent_donation - \n                                 date_of_20th_most_recent_donation)) %&gt;% \n    dplyr::mutate(days = as.numeric(days)) %&gt;% \n    dplyr::pull(days) \n  \n  \n}\n\n# total_num_donations_24_hours = NULL,\n#                    money_raised_24_hours = NULL,\n#                    total_num_donations_last_20 = NULL,\n#                    money_raised_last_20 = NULL,\n#                    num_days_last_20 = NULL\n\n\n# Load necessary librarie\n\n\n#| echo: false\n#| include: false\n\n\nx &lt;- test_tib\n\nfinal_table &lt;-  x %&gt;% \n  dplyr::mutate(amount_raised_num = parse_number(money_raised)) %&gt;% \n  dplyr::mutate(currency = str_extract(money_raised, \"[€|$|kr|£]\")) %&gt;% \n  dplyr::mutate(currency_abv = dplyr::case_when(\n    currency == \"$\" ~ \"USD\",\n    currency == \"€\" ~ \"EUR\",\n    currency == \"£\" ~ \"GBP\",\n    currency == \"k\" ~ \"SEK\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  # dplyr::mutate(amount_raised_in_usd = case_when(\n  #   currency == \"$\" ~ amount_raised_num,\n  #   currency == \"€\" ~ amount_raised_num*1.074,\n  #   currency == \"£\" ~ amount_raised_num*1.271,\n  #   currency == \"k\" ~ amount_raised_num*0.095,\n  #   TRUE ~ 9999999999999\n  # )) %&gt;% \n  dplyr::mutate(percent_of_goal = amount_raised_num / total_goal_amount) %&gt;% \n  dplyr::left_join(sheet_gaza %&gt;% \n                     dplyr::select(1:2, Status, links),\n                   by = c(\"link\" = \"links\")) %&gt;% \n  dplyr::arrange(desc(Status), percent_of_goal) %&gt;%  \n  dplyr::select(link, link_text = `GFM LINK`,\n                total_num_donations,currency_abv, amount_raised_num, \n                percent_of_goal, total_num_donations_24_hours:num_days_last_20) %&gt;% \n  dplyr::mutate(link_text = str_wrap(link_text, width = 20)) %&gt;% \n  # dplyr::mutate(donate_now_link = paste0(link, \"/donate?source=btn_donate\")) %&gt;% \n  dplyr::mutate(row_n = row_number())\n\n# sum_all_donations_in_usd &lt;- final_table %&gt;%\n#   summarise(sum(amount_raised_in_usd)) %&gt;%\n#   as.numeric() %&gt;%\n#   format(big.mark = \",\")\n\n\n# #| content: valuebox\n# #| title: \"Total Donations in USD\"\n# #| \n# list(\n#   color= \"forestgreen\",\n#   value = paste0(\"$\", sum_all_donations_in_usd),\n#   icon = \"cash\"\n# )\n\n\nlink_text &lt;- final_table %&gt;% \n  dplyr::pull(link_text)\n\n\nfinal_table %&gt;% \n  dplyr::select(-c(link_text)) %&gt;% \n  dplyr::relocate(row_n, .before = link) %&gt;% \n  gt() %&gt;% \n  gt::tab_header(\n    title = \"Creators for Gaza Gofundme Campaign Totals\",\n    subtitle = paste0(\"Updated \", lubridate::now())\n  ) %&gt;% \n  gt::fmt_image(\n    columns = row_n,\n    path = paste0(here::here(), \"/qr-codes\"),\n    file_pattern = \"{x}.png\",\n    width = \"8em\",\n    height = \"8m\"\n  ) %&gt;% \n  gt::fmt_url(\n    columns = link, \n    label = link_text,\n    as_button = TRUE,\n    button_fill = \"firebrick\",\n    button_width = px(140),\n    button_outline = \"black\"\n  ) %&gt;% \n  gt::tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_body(\n      columns = link\n    )\n  ) %&gt;% \n  gt::fmt_currency(\n    columns = c(amount_raised_num, money_raised_24_hours, money_raised_last_20),\n    currency = from_column(column = \"currency_abv\"),\n    decimals = 2\n  ) %&gt;% \n  # gt::fmt_percent(columns = percent_of_goal,\n  #                 decimals = 0) %&gt;%\n  gtExtras::gt_plt_bar_pct(\n    column = percent_of_goal,\n    labels = TRUE,\n    fill = \"pink\",\n    height = 26,\n    width = 100,\n    font_style = \"bold\",\n    font_size = \"12px\",\n    decimals = 0,\n    label_cutoff = 0.2\n  )  %&gt;%\n  gt::tab_options(\n    container.height = pct(100),\n    container.overflow.x = TRUE\n  ) %&gt;%   \n  gt::cols_label(\n    # campaign_title = \"Fundraiser\",\n    total_num_donations = \"Number of donations\",\n    amount_raised_num = \"amount raised\",\n    percent_of_goal = \"Percent of goal reached\",\n    row_n = \"QR Code\"\n  )\n\n\n\n\n\n\n\nCreators for Gaza Gofundme Campaign Totals\n\n\nUpdated 2024-06-21 03:59:55.414797\n\n\nQR Code\nlink\nNumber of donations\ncurrency_abv\namount raised\nPercent of goal reached\ntotal_num_donations_24_hours\nmoney_raised_24_hours\ntotal_num_donations_last_20\nmoney_raised_last_20\nnum_days_last_20\n\n\n\n\n\nMarian, Dena + Ghassan\n112\nUSD\n$6,941.00\n\n\n15%\n\n\n0\n$0.00\n20\n$710.00\n18\n\n\n\nKahmis Ghabayen + family\n311\nUSD\n$13,118.00\n\n\n35%\n\n\n5\n$90.00\n20\n$5,501.00\n5\n\n\n\nEvacuate Mirna's Family\n1.4K\nUSD\n$68,715.00\n\n\n92%\n\n\n4\n$181.00\n20\n$1,220.00\n11\n\n\n\nHelp the Dwaimas Escape Genocide\n1.2K\nUSD\n$35,592.00\n\n\n95%\n\n\n1\n$90.00\n20\n$586.00\n4\n\n\n\nHelp Reem Hamada\n1.2K\nUSD\n$37,283.00\n\n\n100%\n\n\n8\n$220.00\n20\n$641.00\n3\n\n\n\n\n\n\n\n\n# most_recent_donations %&gt;% \n#   ndjson::flatten()\n# \n# library(jsonlite)\n# library(ndjson)\n# \n# jsonlite::toJSON(most_recent_donations , auto_unbox = TRUE) %&gt;% jsonlite::prettify() %&gt;% \n#   # dplyr::pull() %&gt;% \n#   ndjson::flatten()\n# \n# result &lt;- str_match_all(my_text, paste0(\"(?s)\", start_word, \"(.*?)\", end_word))\n# \n# # Extracted values\n# extracted_values &lt;- result[[1]][, 2]\n# \n# sample_fund %&gt;% \n#   # xml2::xml_structure()\n#   # xml2::xml_find_all(\".//li\") %&gt;% \n#   html_text() %&gt;% \n#   enframe() %&gt;% \n#   dplyr::mutate(pattern = str_extract_all(value, pattern = 'created_at\\\\\\\":\\\\\\\".....'))\n#   html_elements(css = \".campaign-sidebar_wrapper__Ay4Wk\") %&gt;% \n#   html_text()\n\n# \n# \n# sample_fund &lt;- read_html(\"https://www.gofundme.com/f/help-us-evacuate-and-receive-a-better-education\")\n# \n# # sample_fund_donation_link &lt;- read_html(\"https://www.gofundme.com/f/help-zeyad-and-his-family-to-evacuate-gaza?modal=donations&tab=all\")\n# # \n# # sample_fund_donation_link %&gt;% \n# #   html_elements(css = \".donation-list_donationListItem__EoNQQ\") %&gt;% \n# #   html_text()\n# \n# \n# # Extract values between start_word and end_word\n# most_recent_donations &lt;- sample_fund %&gt;% \n#   html_text() %&gt;% \n#   enframe() %&gt;% \n#   dplyr::mutate(result = \n#                   str_match_all(value, \n#                                 paste0(\"(?s)\",\n#                                        start_word, \n#                                        \"(.*?)\", \n#                                        end_word))) %&gt;% \n#   dplyr::select(result) %&gt;% \n#   unlist()   \n# \n# \n# # THIS WORKED (NO more 2 columns after unlisting)\n# twenty_most_recent_donations &lt;-  most_recent_donations_unlist[[2]][1] %&gt;% \n#   enframe() %&gt;% \n#   tidyr::separate_longer_delim(value, delim = \"donation_id\") %&gt;% \n#   dplyr::filter(row_number() != 1) %&gt;% \n#   tidyr::separate(value, c(\"donation_id\", \"other\"), sep = \"amount\") %&gt;% \n#   dplyr::mutate(donation_id = readr::parse_number(donation_id)) %&gt;% \n#   tidyr::separate(other, c(\"amount\", \"other\"), sep = \"is_offline\") %&gt;% \n#   dplyr::mutate(amount = readr::parse_number(amount)) %&gt;%   \n#   tidyr::separate(other, c(\"name\", \"other\"), sep = \"created_at\") %&gt;% \n#   dplyr::select(-name) %&gt;% \n#   tidyr::separate(other, c(\"created_at\", \"other\"), sep = \"name\") %&gt;%   \n#   dplyr::mutate(created_at= readr::parse_datetime(str_sub(created_at, start = 6L, end = -12L))) %&gt;% \n#   tidyr::separate(other, c(\"name\", \"other\"), sep = \"profile_url\") %&gt;%   \n#   dplyr::mutate(name = str_sub(name, start = 6L, end = -6L)) %&gt;% \n#   dplyr::select(-other) \n# \n# # created_at is at UTC-5 (aka CST)\n# \n# # check for the donations within the past 24 hours. get the total amount and number of donations to show for each fun\n# twenty_most_recent_donations %&gt;% \n#   dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;% \n#   dplyr::summarise(\n#     num_donations = n(),\n#     total_donations = sum(amount)\n#   )\n# \n# # get the spread from the 20 most recent donations\n# twenty_most_recent_donations %&gt;% \n#   # dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;% \n#   dplyr::summarise(\n#     num_donations = n(),\n#     total_donations = sum(amount),\n#     most_recent_donation = as.Date(max(created_at)),\n#     date_of_20th_most_recent_donation = as.Date(min(created_at))\n#   )",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "index.html#table",
    "href": "index.html#table",
    "title": "The List",
    "section": "",
    "text": "#| echo: false\n#| include: false\n\n# for local\n# drive_auth(path = \".secrets/client_secret.json\")\n# gs4_auth(path = \".secrets/client_secret.json\")\n\n# for gha\ndrive_auth(path = Sys.getenv(\"GOOGLE_AUTHENTICATION_CREDENTIALS\"))\n\ngs4_auth(path = Sys.getenv(\"GOOGLE_AUTHENTICATION_CREDENTIALS\"))\n\nss &lt;- drive_get(id = Sys.getenv(\"GOOGLE_SHEET_ID\") \n                )\n\nsheet_gaza &lt;- read_sheet(ss)\n\n✔ Reading from \"Creators for GFMs &lt;3 SPREADSHEET\".\n\n\n✔ Range 'Sheet1'.\n\n\nNew names:\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...9`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...11`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...12`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...13`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...14`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...15`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...16`\n• `CREATOR ASSIGNED` -&gt; `CREATOR ASSIGNED...17`\n\n# idea, when you click \"find out more, it shows the information about the family on the right side of the dashboar\n\n\n#| echo: false\n#| include: false\n\nall_gfm_links &lt;- sheet_gaza %&gt;% \n  # removing fund with broken link for now\n  janitor::clean_names() %&gt;% \n  dplyr::filter(person_family != \"Jenna/Hashem\",\n                status != \"CLOSED / NOT ACCEPTING DONATIONS\") %&gt;%   \n  dplyr::select(links) %&gt;% \n  dplyr::filter(str_detect(links, \"gofund\"))\n\n\ntest_tib &lt;- tibble(\n  # campaign_title = NULL,\n                   link = NULL,\n                   money_raised = NULL,\n                   total_goal_amount = NULL,\n                   total_num_donations = NULL,\n                   total_num_donations_24_hours = NULL,\n                   money_raised_24_hours = NULL,\n                   total_num_donations_last_20 = NULL,\n                   money_raised_last_20 = NULL,\n                   num_days_last_20 = NULL)\n\n\n\nnum_funds &lt;- nrow(all_gfm_links)\n\n\n#| echo: false\n#| include: false\n\n### for last 20 donations\nstart_word &lt;- '\\\\,\\\\\\\\\\\"donations\\\\\\\\\\\"\\\\:\\\\['\nend_word &lt;- 'suggested_donation_stats'\n\nfor(i in 1:5){\n\n  read_html_func &lt;- read_html(as.character(all_gfm_links[i,1]))\n\n  link &lt;- as.character(all_gfm_links[i,1])\n\n  test_tib[i, \"link\"] = link\n\n  # test_tib[i, \"campaign_title\"] = read_html_func %&gt;%\n  #   html_elements(css = \".p-campaign-header\") %&gt;%\n  #   html_text()\n\n  mr_td =  read_html_func %&gt;%\n    html_elements(css = \".hrt-disp-inline\") %&gt;%\n    html_text()\n\n  test_tib[i, \"money_raised\"] = mr_td[1]\n\n  test_tib[i, \"total_num_donations\"] = stringr::str_sub(mr_td[2], start = 2L, end = -2L)\n\n  total_goal = read_html_func %&gt;%\n    html_elements(css = \".hrt-text-body-sm\") %&gt;%\n    html_text()\n\n  test_tib[i, \"total_goal_amount\"] = readr::parse_number(total_goal[1])\n\n  ### 20 most recent donations\n  most_recent_donations = read_html_func %&gt;%\n    html_text() %&gt;%\n    enframe() %&gt;%\n    dplyr::mutate(result =\n                    str_match_all(value,\n                                  paste0(\"(?s)\",\n                                         start_word,\n                                         \"(.*?)\",\n                                         end_word))) %&gt;%\n    dplyr::select(result) %&gt;%\n    unlist()   \n\n  twenty_most_recent_donations = most_recent_donations[[2]][1] %&gt;% \n    tibble::enframe() %&gt;%\n    tidyr::separate_longer_delim(value, delim = \"donation_id\") %&gt;%\n    dplyr::filter(row_number() != 1) %&gt;%\n    tidyr::separate(value, c(\"donation_id\", \"other\"), sep = \"amount\") %&gt;%\n    dplyr::mutate(donation_id = readr::parse_number(donation_id)) %&gt;%\n    tidyr::separate(other, c(\"amount\", \"other\"), sep = \"is_offline\") %&gt;%\n    dplyr::mutate(amount = readr::parse_number(amount)) %&gt;%\n    tidyr::separate(other, c(\"name\", \"other\"), sep = \"created_at\") %&gt;%\n    dplyr::select(-name) %&gt;%\n    tidyr::separate(other, c(\"created_at\", \"other\"), sep = \"name\") %&gt;%\n    dplyr::mutate(created_at = readr::parse_datetime(str_sub(\n      created_at, start = 6L, end = -12L\n    ))) %&gt;%\n    tidyr::separate(other, c(\"name\", \"other\"), sep = \"profile_url\") %&gt;%\n    dplyr::mutate(name = str_sub(name, start = 6L, end = -6L)) %&gt;%\n    dplyr::select(-other) \n  \n  test_tib[i, \"total_num_donations_24_hours\"] = twenty_most_recent_donations %&gt;%\n    dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;%\n    dplyr::summarise(num_donations = n()) %&gt;% \n    dplyr::pull(num_donations)\n  \n  test_tib[i, \"money_raised_24_hours\"] = twenty_most_recent_donations %&gt;%\n    dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;%\n    dplyr::summarise(total_donations_amount = sum(amount)) %&gt;% \n    dplyr::pull(total_donations_amount)\n\n# get the spread from the 20 most recent donations\n  test_tib[i, \"total_num_donations_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      num_donations = n()\n    ) %&gt;% \n    dplyr::pull(num_donations)\n  \n  test_tib[i, \"money_raised_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      total_donations_amount = sum(amount)\n    ) %&gt;% \n    dplyr::pull(total_donations_amount)\n    \n  test_tib[i, \"num_days_last_20\"] = twenty_most_recent_donations %&gt;%\n    dplyr::summarise(\n      most_recent_donation = max(created_at),\n      date_of_20th_most_recent_donation = min(created_at)\n    ) %&gt;% \n    dplyr::mutate(days = floor(most_recent_donation - \n                                 date_of_20th_most_recent_donation)) %&gt;% \n    dplyr::mutate(days = as.numeric(days)) %&gt;% \n    dplyr::pull(days) \n  \n  \n}\n\n# total_num_donations_24_hours = NULL,\n#                    money_raised_24_hours = NULL,\n#                    total_num_donations_last_20 = NULL,\n#                    money_raised_last_20 = NULL,\n#                    num_days_last_20 = NULL\n\n\n# Load necessary librarie\n\n\n#| echo: false\n#| include: false\n\n\nx &lt;- test_tib\n\nfinal_table &lt;-  x %&gt;% \n  dplyr::mutate(amount_raised_num = parse_number(money_raised)) %&gt;% \n  dplyr::mutate(currency = str_extract(money_raised, \"[€|$|kr|£]\")) %&gt;% \n  dplyr::mutate(currency_abv = dplyr::case_when(\n    currency == \"$\" ~ \"USD\",\n    currency == \"€\" ~ \"EUR\",\n    currency == \"£\" ~ \"GBP\",\n    currency == \"k\" ~ \"SEK\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  # dplyr::mutate(amount_raised_in_usd = case_when(\n  #   currency == \"$\" ~ amount_raised_num,\n  #   currency == \"€\" ~ amount_raised_num*1.074,\n  #   currency == \"£\" ~ amount_raised_num*1.271,\n  #   currency == \"k\" ~ amount_raised_num*0.095,\n  #   TRUE ~ 9999999999999\n  # )) %&gt;% \n  dplyr::mutate(percent_of_goal = amount_raised_num / total_goal_amount) %&gt;% \n  dplyr::left_join(sheet_gaza %&gt;% \n                     dplyr::select(1:2, Status, links),\n                   by = c(\"link\" = \"links\")) %&gt;% \n  dplyr::arrange(desc(Status), percent_of_goal) %&gt;%  \n  dplyr::select(link, link_text = `GFM LINK`,\n                total_num_donations,currency_abv, amount_raised_num, \n                percent_of_goal, total_num_donations_24_hours:num_days_last_20) %&gt;% \n  dplyr::mutate(link_text = str_wrap(link_text, width = 20)) %&gt;% \n  # dplyr::mutate(donate_now_link = paste0(link, \"/donate?source=btn_donate\")) %&gt;% \n  dplyr::mutate(row_n = row_number())\n\n# sum_all_donations_in_usd &lt;- final_table %&gt;%\n#   summarise(sum(amount_raised_in_usd)) %&gt;%\n#   as.numeric() %&gt;%\n#   format(big.mark = \",\")\n\n\n# #| content: valuebox\n# #| title: \"Total Donations in USD\"\n# #| \n# list(\n#   color= \"forestgreen\",\n#   value = paste0(\"$\", sum_all_donations_in_usd),\n#   icon = \"cash\"\n# )\n\n\nlink_text &lt;- final_table %&gt;% \n  dplyr::pull(link_text)\n\n\nfinal_table %&gt;% \n  dplyr::select(-c(link_text)) %&gt;% \n  dplyr::relocate(row_n, .before = link) %&gt;% \n  gt() %&gt;% \n  gt::tab_header(\n    title = \"Creators for Gaza Gofundme Campaign Totals\",\n    subtitle = paste0(\"Updated \", lubridate::now())\n  ) %&gt;% \n  gt::fmt_image(\n    columns = row_n,\n    path = paste0(here::here(), \"/qr-codes\"),\n    file_pattern = \"{x}.png\",\n    width = \"8em\",\n    height = \"8m\"\n  ) %&gt;% \n  gt::fmt_url(\n    columns = link, \n    label = link_text,\n    as_button = TRUE,\n    button_fill = \"firebrick\",\n    button_width = px(140),\n    button_outline = \"black\"\n  ) %&gt;% \n  gt::tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_body(\n      columns = link\n    )\n  ) %&gt;% \n  gt::fmt_currency(\n    columns = c(amount_raised_num, money_raised_24_hours, money_raised_last_20),\n    currency = from_column(column = \"currency_abv\"),\n    decimals = 2\n  ) %&gt;% \n  # gt::fmt_percent(columns = percent_of_goal,\n  #                 decimals = 0) %&gt;%\n  gtExtras::gt_plt_bar_pct(\n    column = percent_of_goal,\n    labels = TRUE,\n    fill = \"pink\",\n    height = 26,\n    width = 100,\n    font_style = \"bold\",\n    font_size = \"12px\",\n    decimals = 0,\n    label_cutoff = 0.2\n  )  %&gt;%\n  gt::tab_options(\n    container.height = pct(100),\n    container.overflow.x = TRUE\n  ) %&gt;%   \n  gt::cols_label(\n    # campaign_title = \"Fundraiser\",\n    total_num_donations = \"Number of donations\",\n    amount_raised_num = \"amount raised\",\n    percent_of_goal = \"Percent of goal reached\",\n    row_n = \"QR Code\"\n  )\n\n\n\n\n\n\n\nCreators for Gaza Gofundme Campaign Totals\n\n\nUpdated 2024-06-21 03:59:55.414797\n\n\nQR Code\nlink\nNumber of donations\ncurrency_abv\namount raised\nPercent of goal reached\ntotal_num_donations_24_hours\nmoney_raised_24_hours\ntotal_num_donations_last_20\nmoney_raised_last_20\nnum_days_last_20\n\n\n\n\n\nMarian, Dena + Ghassan\n112\nUSD\n$6,941.00\n\n\n15%\n\n\n0\n$0.00\n20\n$710.00\n18\n\n\n\nKahmis Ghabayen + family\n311\nUSD\n$13,118.00\n\n\n35%\n\n\n5\n$90.00\n20\n$5,501.00\n5\n\n\n\nEvacuate Mirna's Family\n1.4K\nUSD\n$68,715.00\n\n\n92%\n\n\n4\n$181.00\n20\n$1,220.00\n11\n\n\n\nHelp the Dwaimas Escape Genocide\n1.2K\nUSD\n$35,592.00\n\n\n95%\n\n\n1\n$90.00\n20\n$586.00\n4\n\n\n\nHelp Reem Hamada\n1.2K\nUSD\n$37,283.00\n\n\n100%\n\n\n8\n$220.00\n20\n$641.00\n3\n\n\n\n\n\n\n\n\n# most_recent_donations %&gt;% \n#   ndjson::flatten()\n# \n# library(jsonlite)\n# library(ndjson)\n# \n# jsonlite::toJSON(most_recent_donations , auto_unbox = TRUE) %&gt;% jsonlite::prettify() %&gt;% \n#   # dplyr::pull() %&gt;% \n#   ndjson::flatten()\n# \n# result &lt;- str_match_all(my_text, paste0(\"(?s)\", start_word, \"(.*?)\", end_word))\n# \n# # Extracted values\n# extracted_values &lt;- result[[1]][, 2]\n# \n# sample_fund %&gt;% \n#   # xml2::xml_structure()\n#   # xml2::xml_find_all(\".//li\") %&gt;% \n#   html_text() %&gt;% \n#   enframe() %&gt;% \n#   dplyr::mutate(pattern = str_extract_all(value, pattern = 'created_at\\\\\\\":\\\\\\\".....'))\n#   html_elements(css = \".campaign-sidebar_wrapper__Ay4Wk\") %&gt;% \n#   html_text()\n\n# \n# \n# sample_fund &lt;- read_html(\"https://www.gofundme.com/f/help-us-evacuate-and-receive-a-better-education\")\n# \n# # sample_fund_donation_link &lt;- read_html(\"https://www.gofundme.com/f/help-zeyad-and-his-family-to-evacuate-gaza?modal=donations&tab=all\")\n# # \n# # sample_fund_donation_link %&gt;% \n# #   html_elements(css = \".donation-list_donationListItem__EoNQQ\") %&gt;% \n# #   html_text()\n# \n# \n# # Extract values between start_word and end_word\n# most_recent_donations &lt;- sample_fund %&gt;% \n#   html_text() %&gt;% \n#   enframe() %&gt;% \n#   dplyr::mutate(result = \n#                   str_match_all(value, \n#                                 paste0(\"(?s)\",\n#                                        start_word, \n#                                        \"(.*?)\", \n#                                        end_word))) %&gt;% \n#   dplyr::select(result) %&gt;% \n#   unlist()   \n# \n# \n# # THIS WORKED (NO more 2 columns after unlisting)\n# twenty_most_recent_donations &lt;-  most_recent_donations_unlist[[2]][1] %&gt;% \n#   enframe() %&gt;% \n#   tidyr::separate_longer_delim(value, delim = \"donation_id\") %&gt;% \n#   dplyr::filter(row_number() != 1) %&gt;% \n#   tidyr::separate(value, c(\"donation_id\", \"other\"), sep = \"amount\") %&gt;% \n#   dplyr::mutate(donation_id = readr::parse_number(donation_id)) %&gt;% \n#   tidyr::separate(other, c(\"amount\", \"other\"), sep = \"is_offline\") %&gt;% \n#   dplyr::mutate(amount = readr::parse_number(amount)) %&gt;%   \n#   tidyr::separate(other, c(\"name\", \"other\"), sep = \"created_at\") %&gt;% \n#   dplyr::select(-name) %&gt;% \n#   tidyr::separate(other, c(\"created_at\", \"other\"), sep = \"name\") %&gt;%   \n#   dplyr::mutate(created_at= readr::parse_datetime(str_sub(created_at, start = 6L, end = -12L))) %&gt;% \n#   tidyr::separate(other, c(\"name\", \"other\"), sep = \"profile_url\") %&gt;%   \n#   dplyr::mutate(name = str_sub(name, start = 6L, end = -6L)) %&gt;% \n#   dplyr::select(-other) \n# \n# # created_at is at UTC-5 (aka CST)\n# \n# # check for the donations within the past 24 hours. get the total amount and number of donations to show for each fun\n# twenty_most_recent_donations %&gt;% \n#   dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;% \n#   dplyr::summarise(\n#     num_donations = n(),\n#     total_donations = sum(amount)\n#   )\n# \n# # get the spread from the 20 most recent donations\n# twenty_most_recent_donations %&gt;% \n#   # dplyr::filter((now(tzone = \"UTC\") - hours(5)) - hours(24) &lt;= created_at) %&gt;% \n#   dplyr::summarise(\n#     num_donations = n(),\n#     total_donations = sum(amount),\n#     most_recent_donation = as.Date(max(created_at)),\n#     date_of_20th_most_recent_donation = as.Date(min(created_at))\n#   )",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Creators for Gaza: sign-up form",
    "section": "",
    "text": "Loading…",
    "crumbs": [
      "Sign-up Form"
    ]
  }
]